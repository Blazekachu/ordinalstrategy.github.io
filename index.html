<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ordinal Strategy — Live Bitcoin Block Visual</title>

  <!-- D3.js for treemap rendering -->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    /* Remove margins and make full screen */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: monospace;
      color: #fefefe;
      background: transparent;
    }

    /* Background container for live Bitcoin treemap */
    #treemap-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      z-index: -1;
      background: radial-gradient(circle at center, #1a1a1a 20%, #000000 100%);
    }

    /* Treemap nodes */
    .node {
      position: absolute;
      box-sizing: border-box;
      border-radius: 2px;
      opacity: 0.75;
      transition: transform 2s ease, opacity 0.3s ease;
      animation: glowPulse 3s infinite alternate;
    }

    /* Orange glow animation */
    @keyframes glowPulse {
      0% { filter: drop-shadow(0 0 10px #ff8c00); }
      50% { filter: drop-shadow(0 0 25px #ffb700); }
      100% { filter: drop-shadow(0 0 10px #ff8c00); }
    }

    /* Overlay content (website text / elements) */
    .content {
      position: relative;
      z-index: 2;
      text-align: center;
      top: 40%;
      transform: translateY(-40%);
    }

    h1 {
      font-size: 2.5em;
      letter-spacing: 2px;
      color: #ffb700;
      text-shadow: 0 0 15px #ff8c00;
    }

    p {
      font-size: 1.1em;
      color: #ddd;
    }

    footer {
      position: fixed;
      bottom: 10px;
      width: 100%;
      text-align: center;
      color: #777;
      font-size: 0.9em;
      z-index: 3;
    }
  </style>
</head>
<body>

  <!-- Live Bitcoin background -->
  <div id="treemap-bg"></div>

  <!-- Foreground content -->
  <div class="content">
    <h1>Ordinal Strategy</h1>
    <p>Live Bitcoin Block Transactions — Updated Every 30 Seconds</p>
  </div>

  <footer>
    ⚡ Powered by <a href="https://mempool.space/" target="_blank" style="color:#ff8c00;text-decoration:none;">mempool.space</a>
  </footer>

  <script>
    const width = window.innerWidth;
    const height = window.innerHeight;
    const container = d3.select("#treemap-bg");

    async function fetchBlockData() {
      try {
        const response = await fetch("https://mempool.space/api/mempool/recent");
        const blocks = await response.json();
        renderTreemap(blocks);
      } catch (error) {
        console.error("Failed to fetch mempool data:", error);
      }
    }

    function renderTreemap(blocks) {
      container.selectAll("*").remove();

      const data = {
        name: "mempool",
        children: blocks.map((block) => ({
          name: block.tx_count,
          value: block.size,
        })),
      };

      const root = d3.hierarchy(data).sum((d) => d.value);
      d3.treemap().size([width, height]).padding(1)(root);

      const colorScale = d3.scaleSequential()
        .domain([0, d3.max(root.leaves(), (d) => d.value)])
        .interpolator(d3.interpolateWarm);

      const nodes = container
        .selectAll(".node")
        .data(root.leaves())
        .enter()
        .append("div")
        .attr("class", "node")
        .style("left", (d) => d.x0 + "px")
        .style("top", (d) => d.y0 + "px")
        .style("width", (d) => d.x1 - d.x0 + "px")
        .style("height", (d) => d.y1 - d.y0 + "px")
        .style("background", (d) => colorScale(d.value))
        .style("box-shadow", "0 0 15px rgba(255, 140, 0, 0.6)");

      // Parallax floating animation
      function animateParallax() {
        nodes.each(function() {
          const node = d3.select(this);
          const randomX = (Math.random() - 0.5) * 20;
          const randomY = (Math.random() - 0.5) * 20;
          node.transition()
            .duration(4000 + Math.random() * 3000)
            .ease(d3.easeSinInOut)
            .style("transform", `translate(${randomX}px, ${randomY}px)`)
            .on("end", animateParallax);
        });
      }
      animateParallax();
    }

    // Initial load
    fetchBlockData();

    // Refresh every 30 seconds
    setInterval(fetchBlockData, 30000);
  </script>
</body>
</html>
